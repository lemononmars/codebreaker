<script lang=ts>

   import {CreditCardIcon, UsersIcon, ClockIcon, ShoppingCartIcon, HomeIcon, GitBranchIcon, PlayCircleIcon, ShuffleIcon, ChevronDownIcon, ChevronUpIcon} from 'svelte-feather-icons'
   import TrainTrial from '$lib/images/traintrial.png'
   import {default as IntObs} from "svelte-intersection-observer";
   import {fly} from 'svelte/transition'

   import {MRTLogo, BTSLogo, CBLogo, GameLabLogo} from '$lib/images/index'

   let element: any
   let intersecting: boolean

   let answer: string = ''
   let response: string = ''
   let solved: boolean = false
   let solution = '‡∏´‡∏≠‡∏°'
   let openModal = false

   function checkAnswer() {
      if(solved) return

      if(answer.toUpperCase() === solution){
         solved = true
         openModal = true
         response = answer + ' ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! üéâ'
      }
      else
         response = answer + ' ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å'
      answer = ''
   }

   function handleKeyPress(event: KeyboardEvent) {
		if (event.code != "Enter") return;
		checkAnswer()
	}

   function scrollTop() {
		window.scroll({ top: 0, behavior: 'smooth' });
	}

   const sections = [
      {id: 'introduction', title: '‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥'},
      {id: 'info', title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'},
      {id: 'purchase', title: '‡∏ß‡∏¥‡∏ò‡∏µ‡∏ã‡∏∑‡πâ‡∏≠'},
      {id: 'howtoplay', title: '‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô'},
      {id: 'test', title: '‡∏ó‡∏î‡∏•‡∏≠‡∏á'},
      {id: 'faq', title: '‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢'},
      {id: 'partners', title: '‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÇ‡∏î‡∏¢'},
   ]
</script>

<h1>Bangkok Train Puzzle Adventure</h1>

<div class="flex justify-center">
   <iframe width="560" height="315" src="https://www.youtube.com/embed/AGT3JNh4F0w" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

{intersecting}

<div class="bg-success-content py-4 my-4" id="introduction">
   <h2>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h2>
</div>

<p class="whitespace-pre-wrap">
Thank you for always riding with us, the Tokyo Metro.
This year too, we have set puzzles around Tokyo for you.

The puzzles will pull you out into the streets.
The destinations are places you‚Äôve never been, food you‚Äôve never tried‚Ä¶
You will encounter lots of ‚Äúfirst times‚Äù.

Sometimes, you will have to solve puzzles
without knowing where you‚Äôre headed.
Will you embark on an adventure of unknown excitement and discovery?

Now then, let's see you solve the puzzles we have set out for you.
The best way to get around is, of course, with Tokyo Metro.
</p>

<IntObs {element} once bind:intersecting>
   <div class="bg-success-content py-4 my-4" id="info" bind:this={element}>
      <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
   </div>
</IntObs>

{#if intersecting}
   <div class="flex flex-row justify-around" transition:fly={{y:100, delay: 1000, duration: 500}}>
      <div class="flex flex-col border-2 rounded-xl justify-center w-32 h-32 gap-2">
         <h3>‡∏£‡∏≤‡∏Ñ‡∏≤</h3>
         <CreditCardIcon size=2x class="mx-auto"/>
         <p>1000 ‡∏ö‡∏≤‡∏ó</p>
      </div>
      <div class="flex flex-col border-2 rounded-xl justify-center w-32 h-32 gap-2">
         <h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏•‡πà‡∏ô</h3>
         <UsersIcon size=2x class="mx-auto"/>
         <p>1 ‡∏Ñ‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ</p>
      </div>
      <div class="flex flex-col border-2 rounded-xl justify-center w-32 h-32 gap-2">
         <h3>‡πÄ‡∏ß‡∏•‡∏≤</h3>
         <ClockIcon size=2x class="mx-auto"/>
         <p>‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î</p>
      </div>
   </div>
{/if}

<div class="text-center mt-12">
   <h3>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
   <p>1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2566 - 28 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2566</p>
</div>

<div class="bg-success-content py-4 my-4" id="purchase">
   <h2>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ã‡∏∑‡πâ‡∏≠</h2>
</div>
<div class="flex flex-row justify-around">
   <div class="flex flex-col border-2 rounded-xl justify-center w-72 h-32 gap-2">
      <h3>1. ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</h3>
      <ShoppingCartIcon size=2x class="mx-auto"/>
      <p>‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
   </div>
   <div class="flex flex-col border-2 rounded-xl justify-center w-72 h-32 gap-2">
      <h3>2. Board Game Station at BTS Ari </h3>
      <HomeIcon size=2x class="mx-auto"/>
      <a href="//https://www.facebook.com/BoardGameStationAri" target="_blank">‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡πÄ‡∏•‡∏¢</a>
   </div>
</div>

<div class="flex justify-center my-8">
<iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d15499.97127004578!2d100.5444229!3d13.7793064!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x58a5e5d8c311a552!2sBoard%20Game%20Station%20at%20BTS%20Ari!5e0!3m2!1sen!2sth!4v1658925631059!5m2!1sen!2sth" width="600" height="250" style="border:0;" allowfullscreen={true} loading="lazy" referrerpolicy="no-referrer-when-downgrade" title="shop map"></iframe>
</div>

<div class="bg-success-content py-4 my-4" id="howtoplay">
   <h2>‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏•‡πà‡∏ô</h2>
</div>

<div class="grid grid-cols-2 place-items-center">
   <div class="flex flex-col justify-center w-72 h-72 gap-2">
      <h3>1. ‡∏ã‡∏∑‡πâ‡∏≠‡∏ä‡∏∏‡∏î‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤</h3>
      <ShoppingCartIcon size=5x class="mx-auto"/>
      <p><a href="./train#purchase">‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</a></p>
   </div>
   <div class="flex flex-col justify-center w-72 h-72 gap-2">
      <h3>2. ‡πÅ‡∏Å‡πâ‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤</h3>
      <GitBranchIcon size=5x class="mx-auto"/>
      <p>‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏£‡∏ñ‡πÑ‡∏ü‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ</p>
   </div>
   <div class="flex flex-col justify-center w-72 h-72 gap-2">
      <h3>3. ‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏ñ‡πÑ‡∏ü‡∏£‡∏≠‡∏ö‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û</h3>
      <ShuffleIcon size=5x class="mx-auto"/>
      <p>‡πÑ‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ</p>
   </div>
   <div class="flex flex-col justify-center w-72 h-72 gap-2">
      <h3>4. ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</h3>
      <PlayCircleIcon size=5x class="mx-auto"/>
      <p>‡πÅ‡∏Å‡πâ‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ</p>
   </div>
</div>

<div class="bg-success-content py-4 my-4" id="test">
   <h2>‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏¥‡∏®‡∏ô‡∏≤</h2>
</div>

<img src={TrainTrial} alt="trial puzzle" class="p-4 w-full lg:w-2/3 aspect-auto mx-auto"/>

<p>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏°‡∏µ 3 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</p>

<div class="input-group w-72 mx-auto">
   <input class="input input-bordered" type="text" bind:value={answer} on:keydown={handleKeyPress}>
   <div class="btn btn-primary " on:click={checkAnswer}>‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</div>
</div>
{#if solved}
   <p class="text-success">{response}</p>
{:else}
   <p class="text-error">{response}</p>
{/if}

<div class="bg-success-content py-4 my-4 px-4" id="faq">
   <h2>‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</h2>
</div>

   <div tabindex="0" class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
      <div class="collapse-title text-xl font-medium bg-info-content">
        ‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤?
      </div>
      <div class="collapse-content"> 
        <p class="my-4">‡πÑ‡∏î‡πâ! ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏ö‡∏£‡∏∑‡πà‡∏ô ‡πÄ‡∏£‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</p>
      </div>
   </div>

   <div tabindex="0" class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
      <div class="collapse-title text-xl font-medium bg-info-content">
        ‡∏´‡∏≤‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô?
      </div>
      <div class="collapse-content"> 
        <p>‡∏ó‡∏µ‡πà‡πÅ‡∏´‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏≠‡∏¢‡∏π‡πà</p>
      </div>
   </div>

   <div tabindex="0" class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
      <div class="collapse-title text-xl font-medium bg-info-content">
        ‡πÄ‡∏•‡πà‡∏ô‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡πà‡∏≤
      </div>
      <div class="collapse-content"> 
        <p class="my-4">‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠?</p>
      </div>
   </div>

   <div tabindex="0" class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
      <div class="collapse-title text-xl font-medium bg-info-content">
        ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö ‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£‡∏î‡∏µ
      </div>
      <div class="collapse-content"> 
        <p class="my-4">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô</p>
      </div>
   </div>


<div class="bg-success-content py-4 my-4" id="partners">
   <h2>‡∏ú‡∏π‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</h2>
</div>
<div class="flex flex-row justify-around">
   <img src={CBLogo} alt="cb logo" class="w-20 aspect-square"/>
   <a href="//https://metro.bemplc.co.th/MRT-System-Map" target="_blank"><img src={MRTLogo} alt="mrt logo" class="w-20 aspect-square"/></a>
   <a href="//https://www.bts.co.th/" target="_blank"><img src={BTSLogo} alt="bts logo" class="w-20 aspect-square"/></a>
   <a href="//https://http://www.gamelabthailand.com/" target="_blank"><img src={GameLabLogo} alt="bts logo" class="w-20 aspect-square"/></a>
</div>

<div class="fixed bottom-0 right-0 m-4 hover:-translate-y-2 transition-transform">
   <div class="btn btn-circle bg-primary" on:click={scrollTop}>
      <ChevronUpIcon size=3x/>
   </div>
</div>

<div class="hidden lg:block fixed left-0 top-1/2 -translate-y-1/2 m-4">
   <div class="bg-base-100 border-2 border-base-content flex flex-col p-2 text-left"> 
      {#each sections as s}
         <a href="./train#{s.id}">{s.title}</a>
      {/each}
   </div>
</div>

<!-- just a footer-->
<div class="h-20"></div>

<input type="checkbox" id="submit-modal" class="modal-toggle"/>
<!-- svelte-ignore a11y-label-has-associated-control -->
<label class="modal cursor-pointer w-screen" class:modal-open={openModal} on:click={()=>openModal = false}>
   <label class="modal-box relative" for="">
      <h3 class="text-xl font-bold m-2">"{solution}" ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! üéâ</h3>
      <div class="btn btn-block btn-outline" on:click={()=>openModal = false}>‡πÄ‡∏¢‡πà!</div>
   </label>
</label>

<style>
   h2 {
      margin: top 2rem
   }

   html {
      scroll-behavior: smooth;
   }
</style>